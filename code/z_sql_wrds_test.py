#%%

import wrds
#%%
# conn.list_libraries().sort()
# type(conn.list_libraries())

db = wrds.Connection(wrds_username='jowiing')
db.raw_sql('SELECT date,dji FROM djones.djdaily')
# %%


# KÃ˜R Characteristics
import wrds
db = wrds.Connection(wrds_username='jowiing')

# Define the SQL query as a multi-line string.
sql_query = """
SELECT
    contrib_global_factor.global_factor.obs_main,
    contrib_global_factor.global_factor.exch_main,
    contrib_global_factor.global_factor.common,
    contrib_global_factor.global_factor.primary_sec,
    contrib_global_factor.global_factor.permno,
    contrib_global_factor.global_factor.date,
    contrib_global_factor.global_factor.permco,
    contrib_global_factor.global_factor.gvkey,
    contrib_global_factor.global_factor.iid,
    contrib_global_factor.global_factor.id,
    contrib_global_factor.global_factor.excntry,
    contrib_global_factor.global_factor.eom,
    contrib_global_factor.global_factor.size_grp,
    contrib_global_factor.global_factor.me,
    contrib_global_factor.global_factor.me_company,
    contrib_global_factor.global_factor.ret_exc_lead1m,
    contrib_global_factor.global_factor.ret_exc,
    contrib_global_factor.global_factor.ret,
    contrib_global_factor.global_factor.ret_local,
    contrib_global_factor.global_factor.ret_lag_dif,
    contrib_global_factor.global_factor.prc_local,
    contrib_global_factor.global_factor.prc_high,
    contrib_global_factor.global_factor.prc_low,
    contrib_global_factor.global_factor.bidask,
    contrib_global_factor.global_factor.curcd,
    contrib_global_factor.global_factor.fx,
    contrib_global_factor.global_factor.gics,
    contrib_global_factor.global_factor.naics,
    contrib_global_factor.global_factor.sic,
    contrib_global_factor.global_factor.ff49,
    contrib_global_factor.global_factor.dolvol,
    contrib_global_factor.global_factor.shares,
    contrib_global_factor.global_factor.tvol,
    contrib_global_factor.global_factor.adjfct,
    contrib_global_factor.global_factor.comp_tpci,
    contrib_global_factor.global_factor.crsp_shrcd,
    contrib_global_factor.global_factor.comp_exchg,
    contrib_global_factor.global_factor.crsp_exchcd,
    contrib_global_factor.global_factor.source_crsp,
    contrib_global_factor.global_factor.prc,
    contrib_global_factor.global_factor.market_equity,
    contrib_global_factor.global_factor.div12m_me,
    contrib_global_factor.global_factor.chcsho_12m,
    contrib_global_factor.global_factor.eqnpo_12m,
    contrib_global_factor.global_factor.ret_1_0,
    contrib_global_factor.global_factor.ret_3_1,
    contrib_global_factor.global_factor.ret_6_1,
    contrib_global_factor.global_factor.ret_9_1,
    contrib_global_factor.global_factor.ret_12_1,
    contrib_global_factor.global_factor.ret_12_7,
    contrib_global_factor.global_factor.ret_60_12,
    contrib_global_factor.global_factor.seas_1_1an,
    contrib_global_factor.global_factor.seas_1_1na,
    contrib_global_factor.global_factor.seas_2_5an,
    contrib_global_factor.global_factor.seas_2_5na,
    contrib_global_factor.global_factor.seas_6_10an,
    contrib_global_factor.global_factor.seas_6_10na,
    contrib_global_factor.global_factor.seas_11_15an,
    contrib_global_factor.global_factor.seas_11_15na,
    contrib_global_factor.global_factor.seas_16_20an,
    contrib_global_factor.global_factor.seas_16_20na,
    contrib_global_factor.global_factor.at_gr1,
    contrib_global_factor.global_factor.sale_gr1,
    contrib_global_factor.global_factor.capx_gr1,
    contrib_global_factor.global_factor.inv_gr1,
    contrib_global_factor.global_factor.debt_gr3,
    contrib_global_factor.global_factor.sale_gr3,
    contrib_global_factor.global_factor.capx_gr3,
    contrib_global_factor.global_factor.inv_gr1a,
    contrib_global_factor.global_factor.lti_gr1a,
    contrib_global_factor.global_factor.sti_gr1a,
    contrib_global_factor.global_factor.coa_gr1a,
    contrib_global_factor.global_factor.col_gr1a,
    contrib_global_factor.global_factor.cowc_gr1a,
    contrib_global_factor.global_factor.ncoa_gr1a,
    contrib_global_factor.global_factor.ncol_gr1a,
    contrib_global_factor.global_factor.nncoa_gr1a,
    contrib_global_factor.global_factor.fnl_gr1a,
    contrib_global_factor.global_factor.nfna_gr1a,
    contrib_global_factor.global_factor.tax_gr1a,
    contrib_global_factor.global_factor.be_gr1a,
    contrib_global_factor.global_factor.ebit_sale,
    contrib_global_factor.global_factor.gp_at,
    contrib_global_factor.global_factor.cop_at,
    contrib_global_factor.global_factor.ope_be,
    contrib_global_factor.global_factor.ni_be,
    contrib_global_factor.global_factor.ebit_bev,
    contrib_global_factor.global_factor.netis_at,
    contrib_global_factor.global_factor.eqnetis_at,
    contrib_global_factor.global_factor.dbnetis_at,
    contrib_global_factor.global_factor.oaccruals_at,
    contrib_global_factor.global_factor.oaccruals_ni,
    contrib_global_factor.global_factor.taccruals_at,
    contrib_global_factor.global_factor.taccruals_ni,
    contrib_global_factor.global_factor.noa_at,
    contrib_global_factor.global_factor.opex_at,
    contrib_global_factor.global_factor.at_turnover,
    contrib_global_factor.global_factor.sale_bev,
    contrib_global_factor.global_factor.rd_sale,
    contrib_global_factor.global_factor.cash_at,
    contrib_global_factor.global_factor.sale_emp_gr1,
    contrib_global_factor.global_factor.emp_gr1,
    contrib_global_factor.global_factor.ni_inc8q,
    contrib_global_factor.global_factor.noa_gr1a,
    contrib_global_factor.global_factor.ppeinv_gr1a,
    contrib_global_factor.global_factor.lnoa_gr1a,
    contrib_global_factor.global_factor.capx_gr2,
    contrib_global_factor.global_factor.saleq_gr1,
    contrib_global_factor.global_factor.niq_be,
    contrib_global_factor.global_factor.niq_at,
    contrib_global_factor.global_factor.niq_be_chg1,
    contrib_global_factor.global_factor.niq_at_chg1,
    contrib_global_factor.global_factor.rd5_at,
    contrib_global_factor.global_factor.dsale_dinv,
    contrib_global_factor.global_factor.dsale_drec,
    contrib_global_factor.global_factor.dgp_dsale,
    contrib_global_factor.global_factor.dsale_dsga,
    contrib_global_factor.global_factor.saleq_su,
    contrib_global_factor.global_factor.niq_su,
    contrib_global_factor.global_factor.capex_abn,
    contrib_global_factor.global_factor.op_atl1,
    contrib_global_factor.global_factor.gp_atl1,
    contrib_global_factor.global_factor.ope_bel1,
    contrib_global_factor.global_factor.cop_atl1,
    contrib_global_factor.global_factor.pi_nix,
    contrib_global_factor.global_factor.ocf_at,
    contrib_global_factor.global_factor.op_at,
    contrib_global_factor.global_factor.ocf_at_chg1,
    contrib_global_factor.global_factor.at_be,
    contrib_global_factor.global_factor.ocfq_saleq_std,
    contrib_global_factor.global_factor.tangibility,
    contrib_global_factor.global_factor.earnings_variability,
    contrib_global_factor.global_factor.aliq_at,
    contrib_global_factor.global_factor.f_score,
    contrib_global_factor.global_factor.o_score,
    contrib_global_factor.global_factor.z_score,
    contrib_global_factor.global_factor.kz_index,
    contrib_global_factor.global_factor.ni_ar1,
    contrib_global_factor.global_factor.ni_ivol,
    contrib_global_factor.global_factor.at_me,
    contrib_global_factor.global_factor.be_me,
    contrib_global_factor.global_factor.debt_me,
    contrib_global_factor.global_factor.netdebt_me,
    contrib_global_factor.global_factor.sale_me,
    contrib_global_factor.global_factor.ni_me,
    contrib_global_factor.global_factor.ocf_me,
    contrib_global_factor.global_factor.fcf_me,
    contrib_global_factor.global_factor.eqpo_me,
    contrib_global_factor.global_factor.eqnpo_me,
    contrib_global_factor.global_factor.rd_me,
    contrib_global_factor.global_factor.ival_me,
    contrib_global_factor.global_factor.bev_mev,
    contrib_global_factor.global_factor.ebitda_mev,
    contrib_global_factor.global_factor.aliq_mat,
    contrib_global_factor.global_factor.eq_dur,
    contrib_global_factor.global_factor.beta_60m,
    contrib_global_factor.global_factor.resff3_12_1,
    contrib_global_factor.global_factor.resff3_6_1,
    contrib_global_factor.global_factor.mispricing_mgmt,
    contrib_global_factor.global_factor.mispricing_perf,
    contrib_global_factor.global_factor.ivol_capm_21d,
    contrib_global_factor.global_factor.iskew_capm_21d,
    contrib_global_factor.global_factor.coskew_21d,
    contrib_global_factor.global_factor.beta_dimson_21d,
    contrib_global_factor.global_factor.ivol_ff3_21d,
    contrib_global_factor.global_factor.iskew_ff3_21d,
    contrib_global_factor.global_factor.ivol_hxz4_21d,
    contrib_global_factor.global_factor.iskew_hxz4_21d,
    contrib_global_factor.global_factor.rmax5_21d,
    contrib_global_factor.global_factor.rmax1_21d,
    contrib_global_factor.global_factor.rvol_21d,
    contrib_global_factor.global_factor.rskew_21d,
    contrib_global_factor.global_factor.zero_trades_21d,
    contrib_global_factor.global_factor.dolvol_126d,
    contrib_global_factor.global_factor.dolvol_var_126d,
    contrib_global_factor.global_factor.turnover_126d,
    contrib_global_factor.global_factor.turnover_var_126d,
    contrib_global_factor.global_factor.zero_trades_126d,
    contrib_global_factor.global_factor.zero_trades_252d,
    contrib_global_factor.global_factor.ami_126d,
    contrib_global_factor.global_factor.ivol_capm_252d,
    contrib_global_factor.global_factor.prc_highprc_252d,
    contrib_global_factor.global_factor.betadown_252d,
    contrib_global_factor.global_factor.bidaskhl_21d,
    contrib_global_factor.global_factor.corr_1260d,
    contrib_global_factor.global_factor.betabab_1260d,
    contrib_global_factor.global_factor.rmax5_rvol_21d,
    contrib_global_factor.global_factor.age,
    contrib_global_factor.global_factor.qmj,
    contrib_global_factor.global_factor.qmj_prof,
    contrib_global_factor.global_factor.qmj_growth,
    contrib_global_factor.global_factor.qmj_safety,
    contrib_global_factor.global_factor.enterprise_value,
    contrib_global_factor.global_factor.book_equity,
    contrib_global_factor.global_factor.assets,
    contrib_global_factor.global_factor.sales,
    contrib_global_factor.global_factor.net_income,
    contrib_global_factor.global_factor.div1m_me,
    contrib_global_factor.global_factor.div3m_me,
    contrib_global_factor.global_factor.div6m_me,
    contrib_global_factor.global_factor.divspc1m_me,
    contrib_global_factor.global_factor.divspc12m_me,
    contrib_global_factor.global_factor.chcsho_1m,
    contrib_global_factor.global_factor.chcsho_3m,
    contrib_global_factor.global_factor.chcsho_6m,
    contrib_global_factor.global_factor.eqnpo_1m,
    contrib_global_factor.global_factor.eqnpo_3m,
    contrib_global_factor.global_factor.eqnpo_6m,
    contrib_global_factor.global_factor.ret_2_0,
    contrib_global_factor.global_factor.ret_3_0,
    contrib_global_factor.global_factor.ret_6_0,
    contrib_global_factor.global_factor.ret_9_0,
    contrib_global_factor.global_factor.ret_12_0,
    contrib_global_factor.global_factor.ret_18_1,
    contrib_global_factor.global_factor.ret_24_1,
    contrib_global_factor.global_factor.ret_24_12,
    contrib_global_factor.global_factor.ret_36_1,
    contrib_global_factor.global_factor.ret_36_12,
    contrib_global_factor.global_factor.ret_48_12,
    contrib_global_factor.global_factor.ret_48_1,
    contrib_global_factor.global_factor.ret_60_1,
    contrib_global_factor.global_factor.ret_60_36,
    contrib_global_factor.global_factor.ca_gr1,
    contrib_global_factor.global_factor.nca_gr1,
    contrib_global_factor.global_factor.lt_gr1,
    contrib_global_factor.global_factor.cl_gr1,
    contrib_global_factor.global_factor.ncl_gr1,
    contrib_global_factor.global_factor.be_gr1,
    contrib_global_factor.global_factor.pstk_gr1,
    contrib_global_factor.global_factor.debt_gr1,
    contrib_global_factor.global_factor.cogs_gr1,
    contrib_global_factor.global_factor.sga_gr1,
    contrib_global_factor.global_factor.opex_gr1,
    contrib_global_factor.global_factor.at_gr3,
    contrib_global_factor.global_factor.ca_gr3,
    contrib_global_factor.global_factor.nca_gr3,
    contrib_global_factor.global_factor.lt_gr3,
    contrib_global_factor.global_factor.cl_gr3,
    contrib_global_factor.global_factor.ncl_gr3,
    contrib_global_factor.global_factor.be_gr3,
    contrib_global_factor.global_factor.pstk_gr3,
    contrib_global_factor.global_factor.cogs_gr3,
    contrib_global_factor.global_factor.sga_gr3,
    contrib_global_factor.global_factor.opex_gr3,
    contrib_global_factor.global_factor.cash_gr1a,
    contrib_global_factor.global_factor.rec_gr1a,
    contrib_global_factor.global_factor.ppeg_gr1a,
    contrib_global_factor.global_factor.intan_gr1a,
    contrib_global_factor.global_factor.debtst_gr1a,
    contrib_global_factor.global_factor.ap_gr1a,
    contrib_global_factor.global_factor.txp_gr1a,
    contrib_global_factor.global_factor.debtlt_gr1a,
    contrib_global_factor.global_factor.txditc_gr1a,
    contrib_global_factor.global_factor.oa_gr1a,
    contrib_global_factor.global_factor.ol_gr1a,
    contrib_global_factor.global_factor.fna_gr1a,
    contrib_global_factor.global_factor.gp_gr1a,
    contrib_global_factor.global_factor.ebitda_gr1a,
    contrib_global_factor.global_factor.ebit_gr1a,
    contrib_global_factor.global_factor.ope_gr1a,
    contrib_global_factor.global_factor.ni_gr1a,
    contrib_global_factor.global_factor.nix_gr1a,
    contrib_global_factor.global_factor.dp_gr1a,
    contrib_global_factor.global_factor.fincf_gr1a,
    contrib_global_factor.global_factor.ocf_gr1a,
    contrib_global_factor.global_factor.fcf_gr1a,
    contrib_global_factor.global_factor.nwc_gr1a,
    contrib_global_factor.global_factor.eqnetis_gr1a,
    contrib_global_factor.global_factor.dltnetis_gr1a,
    contrib_global_factor.global_factor.dstnetis_gr1a,
    contrib_global_factor.global_factor.dbnetis_gr1a,
    contrib_global_factor.global_factor.netis_gr1a,
    contrib_global_factor.global_factor.eqnpo_gr1a,
    contrib_global_factor.global_factor.eqbb_gr1a,
    contrib_global_factor.global_factor.eqis_gr1a,
    contrib_global_factor.global_factor.div_gr1a,
    contrib_global_factor.global_factor.eqpo_gr1a,
    contrib_global_factor.global_factor.capx_gr1a,
    contrib_global_factor.global_factor.cash_gr3a,
    contrib_global_factor.global_factor.inv_gr3a,
    contrib_global_factor.global_factor.rec_gr3a,
    contrib_global_factor.global_factor.ppeg_gr3a,
    contrib_global_factor.global_factor.lti_gr3a,
    contrib_global_factor.global_factor.intan_gr3a,
    contrib_global_factor.global_factor.debtst_gr3a,
    contrib_global_factor.global_factor.ap_gr3a,
    contrib_global_factor.global_factor.txp_gr3a,
    contrib_global_factor.global_factor.debtlt_gr3a,
    contrib_global_factor.global_factor.txditc_gr3a,
    contrib_global_factor.global_factor.coa_gr3a,
    contrib_global_factor.global_factor.col_gr3a,
    contrib_global_factor.global_factor.cowc_gr3a,
    contrib_global_factor.global_factor.ncoa_gr3a,
    contrib_global_factor.global_factor.ncol_gr3a,
    contrib_global_factor.global_factor.nncoa_gr3a,
    contrib_global_factor.global_factor.oa_gr3a,
    contrib_global_factor.global_factor.ol_gr3a,
    contrib_global_factor.global_factor.fna_gr3a,
    contrib_global_factor.global_factor.fnl_gr3a,
    contrib_global_factor.global_factor.nfna_gr3a,
    contrib_global_factor.global_factor.gp_gr3a,
    contrib_global_factor.global_factor.ebitda_gr3a,
    contrib_global_factor.global_factor.ebit_gr3a,
    contrib_global_factor.global_factor.ope_gr3a,
    contrib_global_factor.global_factor.ni_gr3a,
    contrib_global_factor.global_factor.nix_gr3a,
    contrib_global_factor.global_factor.dp_gr3a,
    contrib_global_factor.global_factor.fincf_gr3a,
    contrib_global_factor.global_factor.ocf_gr3a,
    contrib_global_factor.global_factor.fcf_gr3a,
    contrib_global_factor.global_factor.nwc_gr3a,
    contrib_global_factor.global_factor.eqnetis_gr3a,
    contrib_global_factor.global_factor.dltnetis_gr3a,
    contrib_global_factor.global_factor.dstnetis_gr3a,
    contrib_global_factor.global_factor.dbnetis_gr3a,
    contrib_global_factor.global_factor.netis_gr3a,
    contrib_global_factor.global_factor.eqnpo_gr3a,
    contrib_global_factor.global_factor.tax_gr3a,
    contrib_global_factor.global_factor.eqbb_gr3a,
    contrib_global_factor.global_factor.eqis_gr3a,
    contrib_global_factor.global_factor.div_gr3a,
    contrib_global_factor.global_factor.eqpo_gr3a,
    contrib_global_factor.global_factor.capx_gr3a,
    contrib_global_factor.global_factor.capx_at,
    contrib_global_factor.global_factor.rd_at,
    contrib_global_factor.global_factor.spi_at,
    contrib_global_factor.global_factor.xido_at,
    contrib_global_factor.global_factor.nri_at,
    contrib_global_factor.global_factor.gp_sale,
    contrib_global_factor.global_factor.ebitda_sale,
    contrib_global_factor.global_factor.pi_sale,
    contrib_global_factor.global_factor.ni_sale,
    contrib_global_factor.global_factor.nix_sale,
    contrib_global_factor.global_factor.ocf_sale,
    contrib_global_factor.global_factor.fcf_sale,
    contrib_global_factor.global_factor.ebitda_at,
    contrib_global_factor.global_factor.ebit_at,
    contrib_global_factor.global_factor.fi_at,
    contrib_global_factor.global_factor.ni_at,
    contrib_global_factor.global_factor.nix_be,
    contrib_global_factor.global_factor.ocf_be,
    contrib_global_factor.global_factor.fcf_be,
    contrib_global_factor.global_factor.gp_bev,
    contrib_global_factor.global_factor.ebitda_bev,
    contrib_global_factor.global_factor.fi_bev,
    contrib_global_factor.global_factor.cop_bev,
    contrib_global_factor.global_factor.gp_ppen,
    contrib_global_factor.global_factor.ebitda_ppen,
    contrib_global_factor.global_factor.fcf_ppen,
    contrib_global_factor.global_factor.fincf_at,
    contrib_global_factor.global_factor.eqis_at,
    contrib_global_factor.global_factor.dltnetis_at,
    contrib_global_factor.global_factor.dstnetis_at,
    contrib_global_factor.global_factor.eqnpo_at,
    contrib_global_factor.global_factor.eqbb_at,
    contrib_global_factor.global_factor.div_at,
    contrib_global_factor.global_factor.be_bev,
    contrib_global_factor.global_factor.debt_bev,
    contrib_global_factor.global_factor.cash_bev,
    contrib_global_factor.global_factor.pstk_bev,
    contrib_global_factor.global_factor.debtlt_bev,
    contrib_global_factor.global_factor.debtst_bev,
    contrib_global_factor.global_factor.int_debt,
    contrib_global_factor.global_factor.int_debtlt,
    contrib_global_factor.global_factor.ebitda_debt,
    contrib_global_factor.global_factor.profit_cl,
    contrib_global_factor.global_factor.ocf_cl,
    contrib_global_factor.global_factor.ocf_debt,
    contrib_global_factor.global_factor.cash_lt,
    contrib_global_factor.global_factor.inv_act,
    contrib_global_factor.global_factor.rec_act,
    contrib_global_factor.global_factor.debtst_debt,
    contrib_global_factor.global_factor.cl_lt,
    contrib_global_factor.global_factor.debtlt_debt,
    contrib_global_factor.global_factor.lt_ppen,
    contrib_global_factor.global_factor.debtlt_be,
    contrib_global_factor.global_factor.nwc_at,
    contrib_global_factor.global_factor.fcf_ocf,
    contrib_global_factor.global_factor.debt_at,
    contrib_global_factor.global_factor.debt_be,
    contrib_global_factor.global_factor.ebit_int,
    contrib_global_factor.global_factor.inv_days,
    contrib_global_factor.global_factor.rec_days,
    contrib_global_factor.global_factor.ap_days,
    contrib_global_factor.global_factor.cash_conversion,
    contrib_global_factor.global_factor.cash_cl,
    contrib_global_factor.global_factor.caliq_cl,
    contrib_global_factor.global_factor.ca_cl,
    contrib_global_factor.global_factor.inv_turnover,
    contrib_global_factor.global_factor.rec_turnover,
    contrib_global_factor.global_factor.ap_turnover,
    contrib_global_factor.global_factor.adv_sale,
    contrib_global_factor.global_factor.staff_sale,
    contrib_global_factor.global_factor.sale_be,
    contrib_global_factor.global_factor.div_ni,
    contrib_global_factor.global_factor.sale_nwc,
    contrib_global_factor.global_factor.tax_pi,
    contrib_global_factor.global_factor.ni_emp,
    contrib_global_factor.global_factor.sale_emp,
    contrib_global_factor.global_factor.niq_saleq_std,
    contrib_global_factor.global_factor.roeq_be_std,
    contrib_global_factor.global_factor.roe_be_std,
    contrib_global_factor.global_factor.intrinsic_value,
    contrib_global_factor.global_factor.gpoa_ch5,
    contrib_global_factor.global_factor.roe_ch5,
    contrib_global_factor.global_factor.roa_ch5,
    contrib_global_factor.global_factor.cfoa_ch5,
    contrib_global_factor.global_factor.gmar_ch5,
    contrib_global_factor.global_factor.cash_me,
    contrib_global_factor.global_factor.gp_me,
    contrib_global_factor.global_factor.ebitda_me,
    contrib_global_factor.global_factor.ebit_me,
    contrib_global_factor.global_factor.ope_me,
    contrib_global_factor.global_factor.nix_me,
    contrib_global_factor.global_factor.cop_me,
    contrib_global_factor.global_factor.div_me,
    contrib_global_factor.global_factor.eqbb_me,
    contrib_global_factor.global_factor.eqis_me,
    contrib_global_factor.global_factor.eqnetis_me,
    contrib_global_factor.global_factor.at_mev,
    contrib_global_factor.global_factor.ppen_mev,
    contrib_global_factor.global_factor.be_mev,
    contrib_global_factor.global_factor.cash_mev,
    contrib_global_factor.global_factor.sale_mev,
    contrib_global_factor.global_factor.gp_mev,
    contrib_global_factor.global_factor.ebit_mev,
    contrib_global_factor.global_factor.cop_mev,
    contrib_global_factor.global_factor.ocf_mev,
    contrib_global_factor.global_factor.fcf_mev,
    contrib_global_factor.global_factor.debt_mev,
    contrib_global_factor.global_factor.pstk_mev,
    contrib_global_factor.global_factor.debtlt_mev,
    contrib_global_factor.global_factor.debtst_mev,
    contrib_global_factor.global_factor.dltnetis_mev,
    contrib_global_factor.global_factor.dstnetis_mev,
    contrib_global_factor.global_factor.dbnetis_mev,
    contrib_global_factor.global_factor.netis_mev,
    contrib_global_factor.global_factor.fincf_mev,
    contrib_global_factor.global_factor.ivol_capm_60m,
    contrib_global_factor.global_factor.beta_21d,
    contrib_global_factor.global_factor.beta_252d,
    contrib_global_factor.global_factor.rvol_252d,
    contrib_global_factor.global_factor.rvolhl_21d
FROM contrib_global_factor.global_factor
WHERE contrib_global_factor.global_factor.date BETWEEN
    '1952-01-01'::date AND '2024-03-31'::date
  AND ("contrib_global_factor"."global_factor"."excntry" = 'USA')
  AND (
       "contrib_global_factor"."global_factor"."primary_sec" = ANY (ARRAY[1.0])
       AND "contrib_global_factor"."global_factor"."common" = ANY (ARRAY[1.0])
       AND "contrib_global_factor"."global_factor"."exch_main" = ANY (ARRAY[1.0])
       AND "contrib_global_factor"."global_factor"."obs_main" = ANY (ARRAY[1.0])
  )
"""

# Execute the SQL query and load the results into a DataFrame
df = db.raw_sql(sql_query)

# Optionally, inspect the first few rows of the data
print(df.head())







#%%
# KÃ¸rer Monthly
print('Running query for Monthly Stock Returns (US)')

import wrds
db = wrds.Connection(wrds_username='jowiing')

sql_query = """
SELECT
    contrib_global_factor.global_factor.obs_main,
    contrib_global_factor.global_factor.exch_main,
    contrib_global_factor.global_factor.common,
    contrib_global_factor.global_factor.primary_sec,
    contrib_global_factor.global_factor.permno,
    contrib_global_factor.global_factor.date,
    contrib_global_factor.global_factor.permco,
    contrib_global_factor.global_factor.gvkey,
    contrib_global_factor.global_factor.iid,
    contrib_global_factor.global_factor.id,
    contrib_global_factor.global_factor.excntry,
    contrib_global_factor.global_factor.eom,
    contrib_global_factor.global_factor.size_grp,
    contrib_global_factor.global_factor.me,
    contrib_global_factor.global_factor.me_company,
    contrib_global_factor.global_factor.ret_exc_lead1m,
    contrib_global_factor.global_factor.ret_exc,
    contrib_global_factor.global_factor.ret,
    contrib_global_factor.global_factor.ret_local,
    contrib_global_factor.global_factor.ret_lag_dif,
    contrib_global_factor.global_factor.prc_local,
    contrib_global_factor.global_factor.prc_high,
    contrib_global_factor.global_factor.prc_low,
    contrib_global_factor.global_factor.bidask,
    contrib_global_factor.global_factor.curcd,
    contrib_global_factor.global_factor.fx,
    contrib_global_factor.global_factor.gics,
    contrib_global_factor.global_factor.naics,
    contrib_global_factor.global_factor.sic,
    contrib_global_factor.global_factor.ff49,
    contrib_global_factor.global_factor.dolvol,
    contrib_global_factor.global_factor.shares,
    contrib_global_factor.global_factor.tvol,
    contrib_global_factor.global_factor.adjfct,
    contrib_global_factor.global_factor.comp_tpci,
    contrib_global_factor.global_factor.crsp_shrcd,
    contrib_global_factor.global_factor.comp_exchg,
    contrib_global_factor.global_factor.crsp_exchcd,
    contrib_global_factor.global_factor.source_crsp,
    contrib_global_factor.global_factor.prc,
    contrib_global_factor.global_factor.market_equity,
    contrib_global_factor.global_factor.div12m_me,
    contrib_global_factor.global_factor.chcsho_12m,
    contrib_global_factor.global_factor.eqnpo_12m,
    contrib_global_factor.global_factor.ret_1_0,
    contrib_global_factor.global_factor.ret_3_1,
    contrib_global_factor.global_factor.ret_6_1,
    contrib_global_factor.global_factor.ret_9_1,
    contrib_global_factor.global_factor.ret_12_1,
    contrib_global_factor.global_factor.ret_12_7,
    contrib_global_factor.global_factor.ret_60_12,
    contrib_global_factor.global_factor.seas_1_1an,
    contrib_global_factor.global_factor.seas_1_1na,
    contrib_global_factor.global_factor.seas_2_5an,
    contrib_global_factor.global_factor.seas_2_5na,
    contrib_global_factor.global_factor.seas_6_10an,
    contrib_global_factor.global_factor.seas_6_10na,
    contrib_global_factor.global_factor.seas_11_15an,
    contrib_global_factor.global_factor.seas_11_15na,
    contrib_global_factor.global_factor.seas_16_20an,
    contrib_global_factor.global_factor.seas_16_20na,
    contrib_global_factor.global_factor.at_gr1,
    contrib_global_factor.global_factor.sale_gr1,
    contrib_global_factor.global_factor.capx_gr1,
    contrib_global_factor.global_factor.inv_gr1,
    contrib_global_factor.global_factor.debt_gr3,
    contrib_global_factor.global_factor.sale_gr3,
    contrib_global_factor.global_factor.capx_gr3,
    contrib_global_factor.global_factor.inv_gr1a,
    contrib_global_factor.global_factor.lti_gr1a,
    contrib_global_factor.global_factor.sti_gr1a,
    contrib_global_factor.global_factor.coa_gr1a,
    contrib_global_factor.global_factor.col_gr1a,
    contrib_global_factor.global_factor.cowc_gr1a,
    contrib_global_factor.global_factor.ncoa_gr1a,
    contrib_global_factor.global_factor.ncol_gr1a,
    contrib_global_factor.global_factor.nncoa_gr1a,
    contrib_global_factor.global_factor.fnl_gr1a,
    contrib_global_factor.global_factor.nfna_gr1a,
    contrib_global_factor.global_factor.tax_gr1a,
    contrib_global_factor.global_factor.be_gr1a,
    contrib_global_factor.global_factor.ebit_sale,
    contrib_global_factor.global_factor.gp_at,
    contrib_global_factor.global_factor.cop_at,
    contrib_global_factor.global_factor.ope_be,
    contrib_global_factor.global_factor.ni_be,
    contrib_global_factor.global_factor.ebit_bev,
    contrib_global_factor.global_factor.netis_at,
    contrib_global_factor.global_factor.eqnetis_at,
    contrib_global_factor.global_factor.dbnetis_at,
    contrib_global_factor.global_factor.oaccruals_at,
    contrib_global_factor.global_factor.oaccruals_ni,
    contrib_global_factor.global_factor.taccruals_at,
    contrib_global_factor.global_factor.taccruals_ni,
    contrib_global_factor.global_factor.noa_at,
    contrib_global_factor.global_factor.opex_at,
    contrib_global_factor.global_factor.at_turnover,
    contrib_global_factor.global_factor.sale_bev,
    contrib_global_factor.global_factor.rd_sale,
    contrib_global_factor.global_factor.cash_at,
    contrib_global_factor.global_factor.sale_emp_gr1,
    contrib_global_factor.global_factor.emp_gr1,
    contrib_global_factor.global_factor.ni_inc8q,
    contrib_global_factor.global_factor.noa_gr1a,
    contrib_global_factor.global_factor.ppeinv_gr1a,
    contrib_global_factor.global_factor.lnoa_gr1a,
    contrib_global_factor.global_factor.capx_gr2,
    contrib_global_factor.global_factor.saleq_gr1,
    contrib_global_factor.global_factor.niq_be,
    contrib_global_factor.global_factor.niq_at,
    contrib_global_factor.global_factor.niq_be_chg1,
    contrib_global_factor.global_factor.niq_at_chg1,
    contrib_global_factor.global_factor.rd5_at,
    contrib_global_factor.global_factor.dsale_dinv,
    contrib_global_factor.global_factor.dsale_drec,
    contrib_global_factor.global_factor.dgp_dsale,
    contrib_global_factor.global_factor.dsale_dsga,
    contrib_global_factor.global_factor.saleq_su,
    contrib_global_factor.global_factor.niq_su,
    contrib_global_factor.global_factor.capex_abn,
    contrib_global_factor.global_factor.op_atl1,
    contrib_global_factor.global_factor.gp_atl1,
    contrib_global_factor.global_factor.ope_bel1,
    contrib_global_factor.global_factor.cop_atl1,
    contrib_global_factor.global_factor.pi_nix,
    contrib_global_factor.global_factor.ocf_at,
    contrib_global_factor.global_factor.op_at,
    contrib_global_factor.global_factor.ocf_at_chg1,
    contrib_global_factor.global_factor.at_be,
    contrib_global_factor.global_factor.ocfq_saleq_std,
    contrib_global_factor.global_factor.tangibility,
    contrib_global_factor.global_factor.earnings_variability,
    contrib_global_factor.global_factor.aliq_at,
    contrib_global_factor.global_factor.f_score,
    contrib_global_factor.global_factor.o_score,
    contrib_global_factor.global_factor.z_score,
    contrib_global_factor.global_factor.kz_index,
    contrib_global_factor.global_factor.ni_ar1,
    contrib_global_factor.global_factor.ni_ivol,
    contrib_global_factor.global_factor.at_me,
    contrib_global_factor.global_factor.be_me,
    contrib_global_factor.global_factor.debt_me,
    contrib_global_factor.global_factor.netdebt_me,
    contrib_global_factor.global_factor.sale_me,
    contrib_global_factor.global_factor.ni_me,
    contrib_global_factor.global_factor.ocf_me,
    contrib_global_factor.global_factor.fcf_me,
    contrib_global_factor.global_factor.eqpo_me,
    contrib_global_factor.global_factor.eqnpo_me,
    contrib_global_factor.global_factor.rd_me,
    contrib_global_factor.global_factor.ival_me,
    contrib_global_factor.global_factor.bev_mev,
    contrib_global_factor.global_factor.ebitda_mev,
    contrib_global_factor.global_factor.aliq_mat,
    contrib_global_factor.global_factor.eq_dur,
    contrib_global_factor.global_factor.beta_60m,
    contrib_global_factor.global_factor.resff3_12_1,
    contrib_global_factor.global_factor.resff3_6_1,
    contrib_global_factor.global_factor.mispricing_mgmt,
    contrib_global_factor.global_factor.mispricing_perf,
    contrib_global_factor.global_factor.ivol_capm_21d,
    contrib_global_factor.global_factor.iskew_capm_21d,
    contrib_global_factor.global_factor.coskew_21d,
    contrib_global_factor.global_factor.beta_dimson_21d,
    contrib_global_factor.global_factor.ivol_ff3_21d,
    contrib_global_factor.global_factor.iskew_ff3_21d,
    contrib_global_factor.global_factor.ivol_hxz4_21d,
    contrib_global_factor.global_factor.iskew_hxz4_21d,
    contrib_global_factor.global_factor.rmax5_21d,
    contrib_global_factor.global_factor.rmax1_21d,
    contrib_global_factor.global_factor.rvol_21d,
    contrib_global_factor.global_factor.rskew_21d,
    contrib_global_factor.global_factor.zero_trades_21d,
    contrib_global_factor.global_factor.dolvol_126d,
    contrib_global_factor.global_factor.dolvol_var_126d,
    contrib_global_factor.global_factor.turnover_126d,
    contrib_global_factor.global_factor.turnover_var_126d,
    contrib_global_factor.global_factor.zero_trades_126d,
    contrib_global_factor.global_factor.zero_trades_252d,
    contrib_global_factor.global_factor.ami_126d,
    contrib_global_factor.global_factor.ivol_capm_252d,
    contrib_global_factor.global_factor.prc_highprc_252d,
    contrib_global_factor.global_factor.betadown_252d,
    contrib_global_factor.global_factor.bidaskhl_21d,
    contrib_global_factor.global_factor.corr_1260d,
    contrib_global_factor.global_factor.betabab_1260d,
    contrib_global_factor.global_factor.rmax5_rvol_21d,
    contrib_global_factor.global_factor.age,
    contrib_global_factor.global_factor.qmj,
    contrib_global_factor.global_factor.qmj_prof,
    contrib_global_factor.global_factor.qmj_growth,
    contrib_global_factor.global_factor.qmj_safety,
    contrib_global_factor.global_factor.enterprise_value,
    contrib_global_factor.global_factor.book_equity,
    contrib_global_factor.global_factor.assets,
    contrib_global_factor.global_factor.sales,
    contrib_global_factor.global_factor.net_income,
    contrib_global_factor.global_factor.div1m_me,
    contrib_global_factor.global_factor.div3m_me,
    contrib_global_factor.global_factor.div6m_me,
    contrib_global_factor.global_factor.divspc1m_me,
    contrib_global_factor.global_factor.divspc12m_me,
    contrib_global_factor.global_factor.chcsho_1m,
    contrib_global_factor.global_factor.chcsho_3m,
    contrib_global_factor.global_factor.chcsho_6m,
    contrib_global_factor.global_factor.eqnpo_1m,
    contrib_global_factor.global_factor.eqnpo_3m,
    contrib_global_factor.global_factor.eqnpo_6m,
    contrib_global_factor.global_factor.ret_2_0,
    contrib_global_factor.global_factor.ret_3_0,
    contrib_global_factor.global_factor.ret_6_0,
    contrib_global_factor.global_factor.ret_9_0,
    contrib_global_factor.global_factor.ret_12_0,
    contrib_global_factor.global_factor.ret_18_1,
    contrib_global_factor.global_factor.ret_24_1,
    contrib_global_factor.global_factor.ret_24_12,
    contrib_global_factor.global_factor.ret_36_1,
    contrib_global_factor.global_factor.ret_36_12,
    contrib_global_factor.global_factor.ret_48_12,
    contrib_global_factor.global_factor.ret_48_1,
    contrib_global_factor.global_factor.ret_60_1,
    contrib_global_factor.global_factor.ret_60_36,
    contrib_global_factor.global_factor.ca_gr1,
    contrib_global_factor.global_factor.nca_gr1,
    contrib_global_factor.global_factor.lt_gr1,
    contrib_global_factor.global_factor.cl_gr1,
    contrib_global_factor.global_factor.ncl_gr1,
    contrib_global_factor.global_factor.be_gr1,
    contrib_global_factor.global_factor.pstk_gr1,
    contrib_global_factor.global_factor.debt_gr1,
    contrib_global_factor.global_factor.cogs_gr1,
    contrib_global_factor.global_factor.sga_gr1,
    contrib_global_factor.global_factor.opex_gr1,
    contrib_global_factor.global_factor.at_gr3,
    contrib_global_factor.global_factor.ca_gr3,
    contrib_global_factor.global_factor.nca_gr3,
    contrib_global_factor.global_factor.lt_gr3,
    contrib_global_factor.global_factor.cl_gr3,
    contrib_global_factor.global_factor.ncl_gr3,
    contrib_global_factor.global_factor.be_gr3,
    contrib_global_factor.global_factor.pstk_gr3,
    contrib_global_factor.global_factor.cogs_gr3,
    contrib_global_factor.global_factor.sga_gr3,
    contrib_global_factor.global_factor.opex_gr3,
    contrib_global_factor.global_factor.cash_gr1a,
    contrib_global_factor.global_factor.rec_gr1a,
    contrib_global_factor.global_factor.ppeg_gr1a,
    contrib_global_factor.global_factor.intan_gr1a,
    contrib_global_factor.global_factor.debtst_gr1a,
    contrib_global_factor.global_factor.ap_gr1a,
    contrib_global_factor.global_factor.txp_gr1a,
    contrib_global_factor.global_factor.debtlt_gr1a,
    contrib_global_factor.global_factor.txditc_gr1a,
    contrib_global_factor.global_factor.oa_gr1a,
    contrib_global_factor.global_factor.ol_gr1a,
    contrib_global_factor.global_factor.fna_gr1a,
    contrib_global_factor.global_factor.gp_gr1a,
    contrib_global_factor.global_factor.ebitda_gr1a,
    contrib_global_factor.global_factor.ebit_gr1a,
    contrib_global_factor.global_factor.ope_gr1a,
    contrib_global_factor.global_factor.ni_gr1a,
    contrib_global_factor.global_factor.nix_gr1a,
    contrib_global_factor.global_factor.dp_gr1a,
    contrib_global_factor.global_factor.fincf_gr1a,
    contrib_global_factor.global_factor.ocf_gr1a,
    contrib_global_factor.global_factor.fcf_gr1a,
    contrib_global_factor.global_factor.nwc_gr1a,
    contrib_global_factor.global_factor.eqnetis_gr1a,
    contrib_global_factor.global_factor.dltnetis_gr1a,
    contrib_global_factor.global_factor.dstnetis_gr1a,
    contrib_global_factor.global_factor.dbnetis_gr1a,
    contrib_global_factor.global_factor.netis_gr1a,
    contrib_global_factor.global_factor.eqnpo_gr1a,
    contrib_global_factor.global_factor.eqbb_gr1a,
    contrib_global_factor.global_factor.eqis_gr1a,
    contrib_global_factor.global_factor.div_gr1a,
    contrib_global_factor.global_factor.eqpo_gr1a,
    contrib_global_factor.global_factor.capx_gr1a,
    contrib_global_factor.global_factor.cash_gr3a,
    contrib_global_factor.global_factor.inv_gr3a,
    contrib_global_factor.global_factor.rec_gr3a,
    contrib_global_factor.global_factor.ppeg_gr3a,
    contrib_global_factor.global_factor.lti_gr3a,
    contrib_global_factor.global_factor.intan_gr3a,
    contrib_global_factor.global_factor.debtst_gr3a,
    contrib_global_factor.global_factor.ap_gr3a,
    contrib_global_factor.global_factor.txp_gr3a,
    contrib_global_factor.global_factor.debtlt_gr3a,
    contrib_global_factor.global_factor.txditc_gr3a,
    contrib_global_factor.global_factor.coa_gr3a,
    contrib_global_factor.global_factor.col_gr3a,
    contrib_global_factor.global_factor.cowc_gr3a,
    contrib_global_factor.global_factor.ncoa_gr3a,
    contrib_global_factor.global_factor.ncol_gr3a,
    contrib_global_factor.global_factor.nncoa_gr3a,
    contrib_global_factor.global_factor.oa_gr3a,
    contrib_global_factor.global_factor.ol_gr3a,
    contrib_global_factor.global_factor.fna_gr3a,
    contrib_global_factor.global_factor.fnl_gr3a,
    contrib_global_factor.global_factor.nfna_gr3a,
    contrib_global_factor.global_factor.gp_gr3a,
    contrib_global_factor.global_factor.ebitda_gr3a,
    contrib_global_factor.global_factor.ebit_gr3a,
    contrib_global_factor.global_factor.ope_gr3a,
    contrib_global_factor.global_factor.ni_gr3a,
    contrib_global_factor.global_factor.nix_gr3a,
    contrib_global_factor.global_factor.dp_gr3a,
    contrib_global_factor.global_factor.fincf_gr3a,
    contrib_global_factor.global_factor.ocf_gr3a,
    contrib_global_factor.global_factor.fcf_gr3a,
    contrib_global_factor.global_factor.nwc_gr3a,
    contrib_global_factor.global_factor.eqnetis_gr3a,
    contrib_global_factor.global_factor.dltnetis_gr3a,
    contrib_global_factor.global_factor.dstnetis_gr3a,
    contrib_global_factor.global_factor.dbnetis_gr3a,
    contrib_global_factor.global_factor.netis_gr3a,
    contrib_global_factor.global_factor.eqnpo_gr3a,
    contrib_global_factor.global_factor.tax_gr3a,
    contrib_global_factor.global_factor.eqbb_gr3a,
    contrib_global_factor.global_factor.eqis_gr3a,
    contrib_global_factor.global_factor.div_gr3a,
    contrib_global_factor.global_factor.eqpo_gr3a,
    contrib_global_factor.global_factor.capx_gr3a,
    contrib_global_factor.global_factor.capx_at,
    contrib_global_factor.global_factor.rd_at,
    contrib_global_factor.global_factor.spi_at,
    contrib_global_factor.global_factor.xido_at,
    contrib_global_factor.global_factor.nri_at,
    contrib_global_factor.global_factor.gp_sale,
    contrib_global_factor.global_factor.ebitda_sale,
    contrib_global_factor.global_factor.pi_sale,
    contrib_global_factor.global_factor.ni_sale,
    contrib_global_factor.global_factor.nix_sale,
    contrib_global_factor.global_factor.ocf_sale,
    contrib_global_factor.global_factor.fcf_sale,
    contrib_global_factor.global_factor.ebitda_at,
    contrib_global_factor.global_factor.ebit_at,
    contrib_global_factor.global_factor.fi_at,
    contrib_global_factor.global_factor.ni_at,
    contrib_global_factor.global_factor.nix_be,
    contrib_global_factor.global_factor.ocf_be,
    contrib_global_factor.global_factor.fcf_be,
    contrib_global_factor.global_factor.gp_bev,
    contrib_global_factor.global_factor.ebitda_bev,
    contrib_global_factor.global_factor.fi_bev,
    contrib_global_factor.global_factor.cop_bev,
    contrib_global_factor.global_factor.gp_ppen,
    contrib_global_factor.global_factor.ebitda_ppen,
    contrib_global_factor.global_factor.fcf_ppen,
    contrib_global_factor.global_factor.fincf_at,
    contrib_global_factor.global_factor.eqis_at,
    contrib_global_factor.global_factor.dltnetis_at,
    contrib_global_factor.global_factor.dstnetis_at,
    contrib_global_factor.global_factor.eqnpo_at,
    contrib_global_factor.global_factor.eqbb_at,
    contrib_global_factor.global_factor.div_at,
    contrib_global_factor.global_factor.be_bev,
    contrib_global_factor.global_factor.debt_bev,
    contrib_global_factor.global_factor.cash_bev,
    contrib_global_factor.global_factor.pstk_bev,
    contrib_global_factor.global_factor.debtlt_bev,
    contrib_global_factor.global_factor.debtst_bev,
    contrib_global_factor.global_factor.int_debt,
    contrib_global_factor.global_factor.int_debtlt,
    contrib_global_factor.global_factor.ebitda_debt,
    contrib_global_factor.global_factor.profit_cl,
    contrib_global_factor.global_factor.ocf_cl,
    contrib_global_factor.global_factor.ocf_debt,
    contrib_global_factor.global_factor.cash_lt,
    contrib_global_factor.global_factor.inv_act,
    contrib_global_factor.global_factor.rec_act,
    contrib_global_factor.global_factor.debtst_debt,
    contrib_global_factor.global_factor.cl_lt,
    contrib_global_factor.global_factor.debtlt_debt,
    contrib_global_factor.global_factor.lt_ppen,
    contrib_global_factor.global_factor.debtlt_be,
    contrib_global_factor.global_factor.nwc_at,
    contrib_global_factor.global_factor.fcf_ocf,
    contrib_global_factor.global_factor.debt_at,
    contrib_global_factor.global_factor.debt_be,
    contrib_global_factor.global_factor.ebit_int,
    contrib_global_factor.global_factor.inv_days,
    contrib_global_factor.global_factor.rec_days,
    contrib_global_factor.global_factor.ap_days,
    contrib_global_factor.global_factor.cash_conversion,
    contrib_global_factor.global_factor.cash_cl,
    contrib_global_factor.global_factor.caliq_cl,
    contrib_global_factor.global_factor.ca_cl,
    contrib_global_factor.global_factor.inv_turnover,
    contrib_global_factor.global_factor.rec_turnover,
    contrib_global_factor.global_factor.ap_turnover,
    contrib_global_factor.global_factor.adv_sale,
    contrib_global_factor.global_factor.staff_sale,
    contrib_global_factor.global_factor.sale_be,
    contrib_global_factor.global_factor.div_ni,
    contrib_global_factor.global_factor.sale_nwc,
    contrib_global_factor.global_factor.tax_pi,
    contrib_global_factor.global_factor.ni_emp,
    contrib_global_factor.global_factor.sale_emp,
    contrib_global_factor.global_factor.niq_saleq_std,
    contrib_global_factor.global_factor.roeq_be_std,
    contrib_global_factor.global_factor.roe_be_std,
    contrib_global_factor.global_factor.intrinsic_value,
    contrib_global_factor.global_factor.gpoa_ch5,
    contrib_global_factor.global_factor.roe_ch5,
    contrib_global_factor.global_factor.roa_ch5,
    contrib_global_factor.global_factor.cfoa_ch5,
    contrib_global_factor.global_factor.gmar_ch5,
    contrib_global_factor.global_factor.cash_me,
    contrib_global_factor.global_factor.gp_me,
    contrib_global_factor.global_factor.ebitda_me,
    contrib_global_factor.global_factor.ebit_me,
    contrib_global_factor.global_factor.ope_me,
    contrib_global_factor.global_factor.nix_me,
    contrib_global_factor.global_factor.cop_me,
    contrib_global_factor.global_factor.div_me,
    contrib_global_factor.global_factor.eqbb_me,
    contrib_global_factor.global_factor.eqis_me,
    contrib_global_factor.global_factor.eqnetis_me,
    contrib_global_factor.global_factor.at_mev,
    contrib_global_factor.global_factor.ppen_mev,
    contrib_global_factor.global_factor.be_mev,
    contrib_global_factor.global_factor.cash_mev,
    contrib_global_factor.global_factor.sale_mev,
    contrib_global_factor.global_factor.gp_mev,
    contrib_global_factor.global_factor.ebit_mev,
    contrib_global_factor.global_factor.cop_mev,
    contrib_global_factor.global_factor.ocf_mev,
    contrib_global_factor.global_factor.fcf_mev,
    contrib_global_factor.global_factor.debt_mev,
    contrib_global_factor.global_factor.pstk_mev,
    contrib_global_factor.global_factor.debtlt_mev,
    contrib_global_factor.global_factor.debtst_mev,
    contrib_global_factor.global_factor.dltnetis_mev,
    contrib_global_factor.global_factor.dstnetis_mev,
    contrib_global_factor.global_factor.dbnetis_mev,
    contrib_global_factor.global_factor.netis_mev,
    contrib_global_factor.global_factor.fincf_mev,
    contrib_global_factor.global_factor.ivol_capm_60m,
    contrib_global_factor.global_factor.beta_21d,
    contrib_global_factor.global_factor.beta_252d,
    contrib_global_factor.global_factor.rvol_252d,
    contrib_global_factor.global_factor.rvolhl_21d
FROM contrib_global_factor.global_factor
WHERE contrib_global_factor.global_factor.date BETWEEN '1952-01-01'::date AND '2024-03-31'::date
  AND contrib_global_factor.global_factor.excntry = 'USA'
  AND contrib_global_factor.global_factor.primary_sec = ANY (ARRAY[1.0])
  AND contrib_global_factor.global_factor.common      = ANY (ARRAY[1.0])
  AND contrib_global_factor.global_factor.exch_main   = ANY (ARRAY[1.0])
  AND contrib_global_factor.global_factor.obs_main    = ANY (ARRAY[1.0])
"""

#%%


